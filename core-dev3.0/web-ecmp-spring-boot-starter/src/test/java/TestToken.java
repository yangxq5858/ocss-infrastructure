import com.ecmp.util.JwtTokenUtil;

import java.util.HashMap;
import java.util.Map;

/**
 * @author Vision.Mac
 * @version 1.0.1 2018/8/30 9:51
 */
public class TestToken {

    public static void main(String[] args) {
//        String json = "{\"authorities\":[{\"authority\":\"TenantAdmin\",\"features\":{\"PCP_XS_WEB\":{\"PCP_XSXQ_CD_XZ\":\"placeSaleDemand/saveWithoutSaleDemand\",\"PCP_XSXQ_CD_SCBG\":\"placeSaleDemand/saveProduceModify\",\"PCP_XSXQ_CD_DC\":\"placeSaleDemand/exportExcel\",\"PCP_XSXQ_XS_LS\":\"placeSaleDemand/listHistoryVersion\",\"PCP_XSXQ_XS_BG\":\"placeSaleDemand/saveModifySaleDemand\",\"PCP_XSXQ_CD_FB\":\"placeSaleDemand/publish\",\"PCP_XSXQ_CD_DRBC\":\"placeSaleDemand/saveImportData\",\"PCP_XSXQ_CD_BJ\":\"placeSaleDemand/saveEditDemand\",\"PCP_XSXQ_CD_LS\":\"placeSaleDemand/listHistoryVersion\",\"PCP_XSXQ_CD_CF\":\"placeSaleDemand/savePlaceSplit\",\"PCP_XSXQ_CD_SC\":\"placeSaleDemand/deleteDemand\",\"PCP_XSXQ_CD_DR\":\"placeSaleDemand/importFromExcel\",\"PCP_XSXQ_CD_BBDC\":\"placeSaleDemand/exportReport\",\"PCP_XSXQ_CD_CDBG\":\"placeSaleDemand/savePlaceModify\",\"PCP_XSXQ_XS_XZ\":\"placeSaleDemand/saveWithSaleDemand\",\"PCP_XSXQ_CD_TJ\":\"placeSaleDemand/submit\",\"PCP_XSXQ_SALEDEMAND\":\"placeSaleDemand/show\",\"PCP_XSXQ_XS_DC\":\"placeSaleDemand/exportExcel\",\"PCP_XSXQ_CD_MB\":\"placeSaleDemand/downloadTemplate\"},\"SPC_STC_WEB\":{\"SPC_STC_NBDJD\":\"orderStatusNodeAllocation/show\",\"SPC_STC_USO\":\"usoOrderStatusNode/show\",\"SPC_STC_SCZT\":\"generateOrderStatusNode/show\",\"SPC_STC_HZLB\":\"stcOrderStatusNode/show\",\"SPC_STC_WBXJD\":\"externalOrderStatusNodeItemAllocation/show\",\"SPC_STC_R3\":\"r3OrderStatusNode/show\",\"SPC_STC_NWYS\":\"orderStatusNodeItemMap/show\",\"SPC_STC_WBDJD\":\"externalOrderStatusNodeAllocation/show\",\"SPC_STC_NBXJD\":\"orderStatusNodeItemAllocation/show\",\"SPC_STC_LRP\":\"lrpOrderStatusNode/show\"},\"BASIC_WEB\":{\"BASIC-QXGL-QXSJZS\":\"displayDataAuth/show\",\"BASIC-YHGL-GSGL\":\"corporation/show\",\"GNJSGLYM_CHECK\":\"featureRole/listAllByFeatureRoleGroup\",\"BASIC-XZQYGL-GJGL\":\"country/show\",\"BASIC-YHGL-GYSYHGL_SAVE\":\"supplierUser/save\",\"BASIC-QXGL-GNJSGL\":\"featureRole/show\",\"BASIC-ZZJG-CKQXGS\":\"corporation/listAllUserAuthorizedCorporations\",\"SJJSGLYM\":\"dataRole/listAllDataRoleGroup\",\"GNJSGLYM_DELETE\":\"featureRole/deleteFeatureRoleGroup/\",\"GNJSGLYM_SAVE\":\"featureRole/saveFeatureRoleGroup\",\"GNJSPZ2\":\"featureRole/listAllUnassignedFeatureByRoleId/\",\"BASIC-ZZJG-CKWDJZZJG\":\"organization/listAllOrgTreeWithoutFrozen/\",\"GNJSPZ1\":\"featureRole/listAllAssignFeatureByRoleId/\",\"SJJSGLYM_DELETE_SAVE\":\"dataRole/saveDataRoleGroup\",\"BASIC-QXGL-SJJSGL\":\"dataRole/show\",\"BASIC-YHGL-GYSYHGL_CHECK\":\"supplierUser/listVoByPage\",\"BASIC-YHGL-GYSYHGL\":\"supplierUser/show\",\"BASIC-ZZJG-ZZJGGL\":\"organization/show\",\"BASIC-ZZJG-GWLBGL\":\"positionCategory/show\",\"BASIC-XZQYGL-XZQY\":\"region/show\",\"BASIC-YHGL-ZJYH-FREEZE\":\"expertUser/freeze\",\"BASIC-ZZJG-GWLBCJ\":\"positionCategory/save\",\"BASIC-YHGL-QYYHGL\":\"userManagement/show\",\"BASIC-YHGL-LY\":\"professionalDomain/show\",\"BASIC-YHGL-GYSYHGL_USER_SAVE\":\"supplierUser/saveSupplierUserVo\",\"SJJSGLYM_CHECK\":\"dataRole/listAllDataRoleByRoleGroupId\",\"BASIC-YHGL-ZJYH\":\"expertUser/show\",\"BASIC-YHGL-GYSYHGL_USER_FP4\":\"userManagement/listAllCanAssignDataRolesByUser\",\"SJJSGLYM_DELETE\":\"dataRole/deleteDataRoleGroup/\",\"BASIC-YHGL-CXYG\":\"organization/listAllOrgTreeWithoutFrozen/\",\"BASIC-ZZJG-CKZZJG\":\"organization/listAllOrgByTenantCode\",\"BASIC-YHGL-GYSYHGL_USER_FP2\":\"userManagement/listAllAssignedDataRoles/\",\"BASIC-ZZJG-CKQXZZJG\":\"organization/listAllUserAuthOrganizations\",\"BASIC-YHGL-GYSYHGL_USER_FP3\":\"userManagement/listAllAssignedFeatureRoles/\",\"BASIC-ZZJG-GWGL\":\"position/show\",\"BASIC-QYYG\":\"position/listAllCanAssignEmployeesIncludeSubNode/\",\"GNJSGLYM\":\"featureRole/listAllFeatureRoleGroup\",\"BASIC-YHGL-GYSYHGL_USER_DELETE\":\"supplierUser/delete\",\"BASIC-YHGL-GYSYHGL_USER_FP1\":\"userManagement/listAllCanAssignFeatureRolesByUser/\",\"SJJSPZ\":\"dataRole/listDataAuthorizeTypeByDataRole/\"},\"PCP_BAF_WEB\":{\"PCP-ERP-SALES_ORGANIZATIONS\":\"erpSalesOrganizations/show\",\"PCP-ERP-FACTORYMATERIALS\":\"erpFactoryMaterials/show\",\"BAF_PRODUCTVARIETY_COPY\":\"productVariety/show\",\"PCP-ERP-CUSTOMER\":\"customer/show\",\"BAF_ORGCOMPARATIONSTREE\":\"orgComparationsTree/show\",\"BAF_ADVANCEDAYSCONFIGS\":\"advanceDaysConfigs/show\",\"BAF_DAILYSHIFT\":\"dailyShift/show\",\"BAF-JGMYWL\":\"tradeMaterialsBill/viewPage\",\"BAF_PRODUCTATTRMAINTENANCE\":\"productAttrMaintenance/show\",\"REVIEWMACHINEMODEL\":\"reviewMachineModel/show\",\"PCP-ERP-SUPPLIERS\":\"erpSuppliers/show\",\"BAF_ACTIVEPERIOD\":\"activePeriod/show\",\"BAF_DATADICTIONARYITEM\":\"dataDictionaryItem/show\",\"PCP-ERP-PURCHASEINFOS\":\"erpPurchaseInfos/show\",\"BAF_LOCATION_PRO_FACTORY_LINE\":\"manufactory/show\",\"BAF_REVIEWMACHINEMODEL\":\"reviewMachineModel/show\",\"PCP-ERP-PURCHASING-GROUP\":\"erpPurchasingGroups/show\",\"BAF_STOCKAREAS\":\"stockAreas/show\",\"BAF_BMAINPART\":\"bMainPart/show\",\"BAF_PRODUCTS\":\"products/show\",\"RESERVEBOM\":\"reserveBom/show\",\"BAF_PRODUCTLINES\":\"productLines/show\",\"BAF_PRODUCTRELATIONS\":\"productRelations/show\",\"PCP-ERP-ERPGROUPMATERIALS\":\"erpGroupMaterials/show\",\"BAF_ORDERPLANTYPES\":\"orderPlanTypes/show\",\"BAF_LOCATIONTYPES\":\"locationTypes/show\",\"BAF_PRODUCTCATAGORIES\":\"productCatagories/show\",\"PCP-ERP-PRODUCT-GROUPS\":\"erpProductGroups/show\",\"BAF_ORGTYPES\":\"orgTypes/show\",\"PCP-ERP-ERPMRPCONTROLLERS\":\"erpMRPControllers/show\",\"AVAILABLERESOURCE\":\"availableResource/show\",\"BAF_PRODUCTSTANDARDS\":\"productStandards/show\",\"BAF_PRODUCT_MAINDATA\":\"productMainData/show\",\"BAF_FACTORY_MRPAERA_LOCATION\":\"factoryMRPArea/show\",\"PCP-ERP-FACTORY\":\"erpFactories/show\",\"PCP-ERP-PURCHASING-ORGS\":\"erpPurchasingOrgs/show\",\"PCP-ERP-ERPWAREHOUSELOCATIONS\":\"erpWarehouseLocations/show\",\"PCP-ERP-ERPSALESOFFICES\":\"erpSalesOffices/show\",\"BAF_PRODUCTSERIOUSES\":\"productSeriouses/show\",\"PCP-ERP-PURCHASING_TYPES\":\"erpPurchasingTypes/show\",\"BAF_FACTORYMATERIAL\":\"factoryMaterials/show\",\"BAF_ORGSALESSTOCKAREAS\":\"orgSalesStockAreas/show\",\"BAF_MRPREFLINES\":\"mrpRefLines/show\",\"BAF_PRODUCTINFOS\":\"productInfos/show\",\"PCP-ERP-QUOTAS\":\"erpQuotas/show\",\"PCP-ERP-ERPMRPAREA\":\"ERPMRPArea/show\"},\"TASK_WEB\":{\"TASK-HTPZ-HTZYPZ\":\"job/show\"},\"PCP_SC_WEB\":{\"PCP_SCJH_ZJYJH_CF\":\"mainPlans/split\",\"PCP_SCJH_ZJSBJH_CX\":\"mainPlansFailure/undo\",\"PCP_SCJH_BJYJH_DELETE\":\"partMainPlans/delete\",\"PCP_SCJH_ZJYJH_XZBJ\":\"mainPlans/save\",\"PCP_SCJH_ZJYJH_DELETE\":\"mainPlans/delete\",\"PCP_MRP_CBWLPS\":\"operationResults/show\",\"PCP_SCJH_BJYJH_DC\":\"partMainPlans/exportPrePlans\",\"PCP_SCJH_ZJYJH_FBJH\":\"mainPlans/creatListOrder\",\"PCP_SCJH_ZJZSJH_GQBB\":\"mainPlansHist/show\",\"MRP_CAP_SHOW\":\"mrpCapacity/show\",\"PCP_SCJH_BJSBJH_CX\":\"partMainPlans/undo\",\"PCP_SCJH_BJZSJH_GQBB\":\"partMainPlansHist/show\",\"PCP_SCJH_ZJZSJH_CF\":\"officialMainPlans/split\",\"PCP_SCJH_BJYJH_XZBJ\":\"partMainPlans/save\",\"PCP_SCJH_ZJXSXQ_PZSCJH\":\"originSaleDemand/transferPlanBatch\",\"PCP_SCJH_ZJJH_CBWL\":\"pbomReserveMaterials/show\",\"PCP_SCJH_BJZSJH_DC\":\"partMainPlans/exportPlans\",\"PCP_SCJH_BJZSJH_BG\":\"partMainPlans/change\",\"PCP_SCJH_ZJYJH_DC\":\"mainPlans/export\",\"PCP_SCJH_BJZSJH_BL\":\"partMainPlans/feedingPlan\",\"PCP_SCJH_PARTMAINPLANS\":\"partMainPlans/show\",\"PCP_SCJH_ZJZSJH_XGPC\":\"officialMainPlans/editSchedule\",\"PCP_SCJH_ZJXSXQ_ZSCJH\":\"originSaleDemand/transferPlan\",\"PCP_SCJH_ZJZSJH_DC\":\"officialMainPlans/export\",\"PCP_SCJH_BJYJH_FBJH\":\"partMainPlans/createProductOrder\",\"PCP_SCJH_ZJZSJH_BG\":\"officialMainPlans/changeOfficialMainPlan\",\"PCP_SCJH_MAINPLANS\":\"mainPlans/show\",\"PCP_SCJH_PRODUCTSCHEDULE\":\"partDistributionPlan/show\",\"PCP_SCJH_BJSBJH_CXFB\":\"partMainPlans/redo\",\"PCP_SCJH_ZJYJH_CXXQ\":\"mainPlans/revoke\",\"PCP_SCJH_ZJYJH_XZCD\":\"mainPlans/saveAndPush\",\"PCP_SCJH_ZJYJH_XGPC\":\"mainPlans/editSchedule\",\"PCP_SCJH_ZJXSXQ_CXXQ\":\"originSaleDemand/cancelOriginSaleDemand\"},\"PCP_CG_WEB\":{\"CGSQ_CBCGJH_CCGDD\":\"resPlans/createorder\",\"CGSQ_CGDD_DC\":\"purOrder/export\",\"CGSQ_CGDD_CX\":\"purOrder/sqlquery\",\"CGSQ_ZBCGJH\":\"purPlans/show\",\"CGSQ_FORECASTPURCHASE_BJ\":\"forecastPurchaseApply/edit\",\"CGSQ_PURAPPLY_PUBLISH\":\"purApply/publish\",\"CGSQ_FORECASTPURCHASE_BG\":\"forecastPurchaseApply/change\",\"CGSQ_PURAPPLY\":\"purApply/show\",\"CGSQ_PURAPPLYDETAILS_SEARCH\":\"purApplyDetails/listByPage\",\"CGSQ_CBCGJH_ZCGJH\":\"resPlans/transform\",\"CGSQ_CBCGJH_CX\":\"resPlans/SQLquery\",\"CGSQ_ZBCGJH_CX\":\"purPlans/SQLquery\",\"CGSQ_PURAPPLYDETAILS_ADD\":\"purApplyDetails/save\",\"CGSQ_CBCGJH_GJCX\":\"resPlans/advancedQuery\",\"CGSQ_CBCGJH_BJ\":\"resPlans/edite\",\"CGSQ_KYZYCJMX\":\"availableOffsetDetails/show\",\"CGSQ_CBCGJH_BG\":\"resPlans/change\",\"CGSQ_CBCGJH\":\"resPlans/show\",\"CGSQ_PURAPPLY_EDIT\":\"purApply/save\",\"CGSQ_CGDD_BG\":\"purOrder/change\",\"CGSQ_PURAPPLY_SEARCH\":\"purApply/listByPage\",\"CGSQ_CBCGJH_SC\":\"resPlans/deleye\",\"CGSQ_FORECASTPURCHASE_DC\":\"forecastPurchaseApply/export\",\"CGSQ_PURAPPLYDETAILS_EDIT\":\"purApplyDetails/save\",\"CGSQ_PURAPPLY_ATTACHMENT\":\"purApply/attachment\",\"CGSQ_PURAPPLYDETAILS_HISTORY\":\"purApplyDetails/history\",\"CGSQ_FORECASTPURCHASE_LS\":\"forecastPurchaseApply/history\",\"CGSQ_PURAPPLYDETAILS_EXPORT\":\"purApplyDetails/export\",\"CGSQ_CBCGJH_SC2\":\"resPlans/delete\",\"CGSQ_PURAPPLY_DELETE\":\"purApply/delete\",\"CGSQ_CGDD\":\"purOrder/show\",\"CGSQ_FORECASTPURCHASE_ZCBJH\":\"forecastPurchaseApply/convert\",\"CGSQ_FORECASTPURCHASE_YSSQ\":\"forecastPurchaseApply/operation\",\"CGSQ_ZBCGJH_CJCGDD\":\"purPlans/createorder\",\"CGSQ_PURAPPLY_IMPORT\":\"purApply/import\",\"CGSQ_KYZYCJMX_SUPER_SEARCH\":\"availableOffsetDetails/listByPage\",\"CGSQ_PURAPPLYDETAILS_CHANGE\":\"purApplyDetails/change\",\"CGSQ_PURAPPLY_ADD\":\"purApply/save\",\"CGSQ_KYZYCJMX_SEARCH\":\"availableOffsetDetails/listByPage\",\"CGSQ_CBCGJH_LS\":\"resPlans/history\",\"CGSQ_FORECASTPURCHASE\":\"forecastPurchaseApply/show\",\"CGSQ_FORECASTPURCHASE_CK\":\"forecastPurchaseApply/check\",\"CGSQ_CBCGJH_DC\":\"resPlans/export\",\"CGSQ_CBCGJH_XZ\":\"resPlans/add\",\"CGSQ_PURAPPLYDETAILS_DELETE\":\"purApplyDetails/delete\",\"CGSQ_CBCGJH_DC2\":\"resPlans/export2\",\"CGSQ_FORECASTPURCHASE_CX\":\"forecastPurchaseApply/query\",\"CGSQ_CGDD_LS\":\"purOrder/history\"}}}],\"tenantCode\":\"10000028\",\"account\":\"pcp001\",\"name\":\"pcp001\",\"principal\":\"pcp001\",\"authenticated\":true,\"credentials\":null,\"details\":{\"accessToken\":\"eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJwY3AwMDEiLCJpcCI6IlVua25vd24iLCJ1c2VyTmFtZSI6IuaZuuiDveWItumAoOeuoeeQhiIsInVzZXJJZCI6IkM3NjQzRkFBLThCNkEtMTFFOC05QkRBLTAyNDJDMEE4NDQwNSIsInJhbmRvbUtleSI6IkIyMjQ3QjkzLUFCRjYtMTFFOC1BNDEzLTAyNDJDMEE4NDQwRCIsImF1dGhvcml0eVBvbGljeSI6IlRlbmFudEFkbWluIiwiYXBwSWQiOiJCODAzMzBCNC0zQTBDLTZCM0EtNTQ3Ny03M0EwNjdFQTkzQ0MiLCJ1c2VyVHlwZSI6IkVtcGxveWVlIiwiZXhwIjoxNTM1NTk3MjY3LCJpYXQiOjE1MzU1OTM2NjcsInRlbmFudCI6IjEwMDAwMDI4IiwiYWNjb3VudCI6InBjcDAwMSIsImVtYWlsIjpudWxsfQ.CNj8KtP1YBxzlLe0D-UzcvzgZSTIs5LzVidGWbTgQQsCSiUazXD1HUOJ_gzRjxXnyYtZVdR_Evj9W-zNurdw3Q\",\"sessionId\":\"B2247B93-ABF6-11E8-A413-0242C0A8440D\",\"userId\":\"C7643FAA-8B6A-11E8-9BDA-0242C0A84405\",\"account\":\"pcp001\",\"userName\":\"智能制造管理\",\"tenantCode\":\"10000028\",\"email\":null,\"userType\":\"Employee\",\"authorityPolicy\":\"TenantAdmin\",\"ip\":\"Unknown\",\"locale\":\"zh_CN\",\"appId\":\"95E74E9C-7A59-697E-DDD1-F6ED954650C8\",\"loginTime\":\"2018-08-30 09:47:47\",\"loginStatus\":\"success\"}}";
//        CoreAuthenticationToken token = JsonUtils.fromJson(json, CoreAuthenticationToken.class);
//        System.out.println(token);

        String token;
        JwtTokenUtil jwtTokenUtil = new JwtTokenUtil();
        jwtTokenUtil.setJwtExpiration(10);
        Map<String, Object> claims = new HashMap<>();
        /*claims.put("key1", "abc");
        claims.put("key2", 123);
        token = jwtTokenUtil.generateToken("admin", jwtTokenUtil.getRandomKey(), claims);
        System.out.println(s);*/

        token = "eyJhbGciOiJIUzUxMiJ9.eyJrZXkxIjoiYWJjIiwicmFuZG9tS2V5IjoieXFieHZ3Iiwia2V5MiI6MTIzLCJzdWIiOiJhZG1pbiIsImV4cCI6MTUzNjcxNDMxOCwiaWF0IjoxNTM2NzE0MzA4fQ.SRiqZzriqdZjS3w-vDWooazTntuIb_HwmPQ7jL4T5y5pAXUNMKFP-jCwnp-kcLFF22ZR0cA-QlMgHK2FnsrheQ";
        String k = jwtTokenUtil.getRandomKeyFromToken(token);
        System.out.println(k);

    }
}
